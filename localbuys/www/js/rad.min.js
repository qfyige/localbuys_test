/**
 * RAD.js
 * v.0.9a
 * Mobidev.biz
 * Date: 8/21/13
 */
(function(a,d){function h(a,c,k){"function"===typeof a&&(k&&k instanceof Object?a.apply(k,c):a(c))}function g(a,c){var k=a.split("."),b=d.RAD,e,f;"RAD"===k[0]&&(k=k.slice(1));e=k.length;for(f=0;f<e;f+=1)void 0===b[k[f]]&&(b[k[f]]=f===e-1?c:{}),b=b[k[f]];return b}function m(){function c(a){a.stopPropagation();a.preventDefault()}var n=/ipad/gi.test(d.navigator.appVersion),k=/android/gi.test(d.navigator.appVersion),b=a.querySelector("#overlay"),e=a.createElement("style");e.appendChild(a.createTextNode('html,body{position:relative;height:100%;overflow:hidden;-ms-touch-action:none;-ms-touch-select:none}body{margin:0;-webkit-text-size-adjust:100%;-webkit-touch-callout:none;-webkit-text-size-adjust:none;-webkit-highlight:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{-moz-user-select:none;-o-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}a,input,textarea,button,div{-webkit-tap-highlight-color:rgba(0,0,0,0);-moz-user-select:text;-o-user-select:text;-khtml-user-select:text;-webkit-user-select:text;-ms-user-select:text;user-select:text}img{border-style:none}input,textarea,select{vertical-align:middle}form,fieldset{margin:0;padding:0;border-style:none}div[data-role=view]{position:absolute;top:0;left:0;width:100%;height:100%;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}#screen{position:relative;height:100%;overflow:hidden}#overlay{display:none}#overlay{position:absolute;z-index:1000;left:0;top:0;width:100%;height:100%}#overlay.show{display:block}.lightbox{position:absolute;z-index:999;left:0;top:0;width:100%;height:100%;opacity:0;text-align:center;white-space:nowrap;-webkit-transition:opacity 300ms ease;-moz-transition:opacity 300ms ease;-ms-transition:opacity 300ms ease;-o-transition:opacity 300ms ease;transition:opacity 300ms ease}.lightbox.show{opacity:1}.lightbox:after{content:"";display:inline-block;vertical-align:middle;width:1px;height:100%}.lightbox-frame{position:relative;display:inline-block;vertical-align:middle;width:100%;text-align:left;white-space:normal;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-moz-transform:scale(0.5,.5);-webkit-transform:scale(0.5,.5);-o-transform:scale(0.5,.5);-ms-transform:scale(0.5,.5);transform:scale(0.5,.5);-webkit-transition:-webkit-transform 300ms ease;-moz-transition:-moz-transform 300ms ease;-ms-transition:-ms-transform 300ms ease;-o-transition:-o-transform 300ms ease;transition:transform 300ms ease}.lightbox.show .lightbox-frame{-moz-transform:scale(1,1);-webkit-transform:scale(1,1);-o-transform:scale(1,1);-ms-transform:scale(1,1);transform:scale(1,1)}.toast{z-index:999;position:absolute;width:auto!important;max-width:50%!important;height:auto!important;opacity:0;-webkit-transition:opacity 300ms ease;-moz-transition:opacity 300ms ease;-ms-transition:opacity 300ms ease;-o-transition:opacity 300ms ease;transition:opacity 300ms ease;text-align:center;display:inline-block}.toast.show{opacity:1;-webkit-transition:opacity 10ms ease;-moz-transition:opacity 10ms ease;-ms-transition:opacity 10ms ease;-o-transition:opacity 10ms ease;transition:opacity 10ms ease}.popup{position:absolute;z-index:999;opacity:0;-webkit-transition:opacity 300ms ease;-moz-transition:opacity 300ms ease;-ms-transition:opacity 300ms ease;-o-transition:opacity 300ms ease;transition:opacity 300ms ease}.popup.show{opacity:1}.slide-in,.slide-out{-webkit-transition:-webkit-transform 350ms ease;-moz-transition:-moz-transform 350ms ease;-ms-transition:-ms-transform 350ms ease;-o-transition:-o-transform 350ms ease;transition:transform 350ms ease}.new-page.slide-in{-webkit-transform:translate3d(100%,0,0);-moz-transform:translate3d(100%,0,0);-ms-transform:translate3d(100%,0,0);-o-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}.old-page.slide-in{-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.animate>.new-page.slide-in{-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.animate>.old-page.slide-in{-webkit-transform:translate3d(-100%,0,0);-moz-transform:translate3d(-100%,0,0);-ms-transform:translate3d(-100%,0,0);-o-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}.new-page.slide-out{-webkit-transform:translate3d(-100%,0,0);-moz-transform:translate3d(-100%,0,0);-ms-transform:translate3d(-100%,0,0);-o-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}.old-page.slide-out{-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.animate>.new-page.slide-out{-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.animate>.old-page.slide-out{-webkit-transform:translate3d(100%,0,0);-moz-transform:translate3d(100%,0,0);-ms-transform:translate3d(100%,0,0);-o-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}.new-page.fade-in,.new-page.fade-out{opacity:0;-webkit-transition:opacity 350ms ease;-moz-transition:opacity 350ms ease;-ms-transition:opacity 350ms ease;-o-transition:opacity 350ms ease;transition:opacity 350ms ease}.old-page.fade-in,.old-page.fade-out{opacity:1;-webkit-transition:opacity 175ms 175ms ease;-moz-transition:opacity 175ms 175ms ease;-ms-transition:opacity 175ms 175ms ease;-o-transition:opacity 175ms 175ms ease;transition:opacity 175ms 175ms ease}.animate>.new-page.fade-in,.animate>.new-page.fade-out{opacity:1}.animate>.old-page.fade-in,.animate>.old-page.fade-out{opacity:0}'));
    a.head.appendChild(e);_.templateSettings={evaluate:/\{\{#([\s\S]+?)\}\}/g,interpolate:/\{\{[^#\{]([\s\S]+?)[^\}]\}\}/g,escape:/\{\{\{([\s\S]+?)\}\}\}/g};d.addEventListener("touchmove",function(a){a.preventDefault()},!1);a.body.onselectstart=function(){return!1};n?d.document.body.className="i-pad":k&&(d.document.body.className="android");b.addEventListener("click",c,!1);b.addEventListener("touchstart",c,!1);b.addEventListener("touchmove",c,!1);b.addEventListener("touchend",c,!1)}function p(a){var c=
{};return{channels:function(){return c},publish:function(k){var b,e,f,l,r,g=k.split("."),h;d.RAD.core.isInitialize||d.RAD.core.initialize();b=arguments[1];if("view"===g[0]||"service"===g[0])if(b&&b.autocreate||"view"!==g[0])l=g[0]+"."+g[1],a.getView(l,a.extractExtras(b));a.options.debug&&(b=this?this.moduleID:void 0,d.console.log(b+" publish:",arguments));b=0;for(l=g.length;b<l;b+=1){e=g[0];f=void 0;for(f=1;f<=b;f+=1)e=e+"."+g[f];h=e;if(c[h])for(e=0,f=c[h].length;e<f;e+=1)r=c[h][e],r.callback.apply(r.context,
    arguments),a.options.debug&&(r=r.context.options||r.context,d.console.log("receiver:"+r.viewID+" channel:"+h,arguments))}},subscribe:function(k,b,e){var f=e.viewID;c[k]||(c[k]=[]);c[k].push({context:e||this,callback:b,ID:f});a.options.debug&&d.console.log(f+" subscribe to channel:"+k,arguments);return this},unsubscribe:function(k,b){var e,f,l;if(!b)return this;l=b.viewID;for(e in c)if(c.hasOwnProperty(e))for(f=c[e].length-1;0<=f;f-=1)if((null===k||k===e)&&c[e][f].ID===l&&(a.options.debug&&d.console.log(l+
    " unsubscribe from channel:"+e,arguments),c[e].splice(f,1),k))return this;return this}}}var c={defaultBackstack:!1,backstackType:"custom",defaultAnimation:"slide",animationTimeout:3E3,debug:!1};d.RAD={core:new function(a,g,k){var b=this,e={},f={},l=new p(b);b.options=c;b.register=function(a,b){void 0===f[a]?f[a]={creator:b,instance:null}:k.console.log("You try register already registered module:"+a+"!")};b.registerAll=function(a){var e,f,k,l;e=0;for(f=a.length;e<f;e+=1)for(l in k=a[e],k)k.hasOwnProperty(l)&&
b.register(l,k[l])};b.startViewOrService=function(a,l){var c;f[a].instance||(c=f[a].creator,"function"!==typeof c?k.console.log("Sorry, but "+a+" wasn't registered!"):(f[a].instance=new c({core:b,application:e,viewID:a,extras:l}),this.options.debug&&k.console.log("create: "+a+" with extras:",l)))};b.startPlugin=function(a){f[a].instance||(f[a].instance=f[a].creator(this,a));this.options.debug&&k.console.log("start plugin:",a)};b.stop=function(a,e,c){var g=f[a],d,I,H;if(g&&g.instance){H=g.instance;
    H instanceof k.RAD.Blanks.View&&H.unbindModel();if(H.children)for(I=0,g=H.children.length;I<g;I+=1)b.stop(H.children[I].content,null);k.setTimeout(function(){if(d=f[a].instance)l.unsubscribe(null,d),d.destroy(),f[a].instance=null,h(e,null,c),b.options.debug&&k.console.log("destroy:"+a)},0)}};b.startAll=function(){var a,e;for(a in f)f.hasOwnProperty(a)&&(e=a.split("."),"plugin"===e[0]?this.startPlugin(a):this.startViewOrService(a))};b.stopAll=function(){for(var a in f)f.hasOwnProperty(a)&&this.stop(a)};
    b.extractExtras=function(a){try{return a.extras}catch(e){return null}};b.getView=function(a,e){var l;if(!a)return null;try{l=f[a].instance}catch(c){return k.console.log("Error - not register view:"+a,c),null}if(null===l||void 0===l)b.startViewOrService(a,e);else if(e)try{l.setExtras(e)}catch(g){k.console.log(g)}return f[a].instance};b.getService=b.getView;b.initialize=function(a,l){var k,c;e=a||e;l&&(b.options=l);b.options.plugins&&"[object Array]"===Object.prototype.toString.call(b.options.plugins)&&
    b.registerAll(b.options.plugins);m();for(k in f)f.hasOwnProperty(k)&&(c=k.split("."),"plugin"===c[0]&&this.startPlugin(k));this.isInitialize=!0};b.getStartedViews=function(){var a,e=[];for(a in f)f.hasOwnProperty(a)&&f[a].instance&&e.push(a);return e};b.document=g;b.window=k;b.$=a;b.subscribe=l.subscribe;b.publish=l.publish;b.channels=l.channels;b.unsubscribe=l.unsubscribe;return b}(d.jQuery,a,d),model:function(a,c,k){var b=c,e=a;"function"!==typeof c||void 0!==k&&!0!==k||(b=new c);-1===a.indexOf("RAD.models.")&&
(e="RAD.models."+a);return g(e,b)},application:function(a,c){var k=a;"function"!==typeof a||void 0!==c&&!0!==c||(k=new a(d.RAD.core));return RAD.application=k},namespace:g};g("RAD.view",g("RAD.service",g("RAD.plugin",function(a,c){var k,b;if("[object Array]"===Object.prototype.toString.call(a))for(k=0,b=a.length;k<b;k+=1)d.RAD.core.register(a[k],c);else d.RAD.core.register(a,c)})));g("RAD.views",{});g("RAD.services",{});g("RAD.plugins",{});g("RAD.models",{});g("RAD.utils",{});g("RAD.scriptLoader",
    new function(){function c(e,b){var l=a.createElement("script");l.type="text/javascript";l.async=!0;l.readyState?l.onreadystatechange=function(){if("loaded"===l.readyState||"complete"===l.readyState)l.onreadystatechange=null,b()}:(l.onload=b,l.onerror=b);l.src=e;a.head.appendChild(l)}function g(a,f,l){function k(){G+=1;G===n&&h(f,null,l)}var d,n=a.length,G=0;b.arr=null;b.callback=null;b.context=null;for(d=0;d<n;d+=1)c(a[d],k)}function k(){b.loadScripts=g;b.arr&&b.callback&&b.loadScripts(b.arr,b.callback,
        b.context)}var b=this;b.loadScripts=function(a,f,c){b.arr=a;b.callback=f;b.context=c};d.attachEvent?d.attachEvent("onload",k):d.addEventListener("load",k,!1);return b});g("RAD.Class",function(){function a(c){return"function"===typeof c}var c=function(){};c.extend=function(c){var b,e=function(e){e!==a&&a(this.initialize)&&this.initialize.apply(this,arguments)};e.prototype=new this(a);for(b in c)(function(f,c){e.prototype[b]=a(f)&&a(c)?function(){this._super=c;return f.apply(this,arguments)}:f})(c[b],
    e.prototype[b]);e.prototype.constructor=e;e.extend=this.extend||this.create;return e};return c}())})(document,window);
RAD.namespace("RAD.Blanks.Deferred",function(){return{listeners:[],done:function(a){this.listeners.push(a)},doneFirstTask:function(a){this.firstTask=a},doneLastTask:function(a){this.lastTask=a},resolve:function(){var a,d,h;this.resolve=function(){};this.doneLastTask=this.doneFirstTask=this.done=function(a){"function"===typeof a&&a()};"function"===typeof this.firstTask&&this.firstTask();a=0;for(d=this.listeners.length;a<d;a+=1)h=this.listeners[a],"function"===typeof h&&h();"function"===typeof this.lastTask&&
this.lastTask();delete this.listeners}}});
RAD.namespace("RAD.Blanks.View",Backbone.View.extend({className:"backbone-view",attributes:{"data-role":"view"},listen:"add remove fetch sort change reset".split(" "),getChildren:function(){this.children||(this.children=[]);return this.children},initialize:function(){var a=this,d,h,g=a.options.extras;a.loader=RAD.Blanks.Deferred();a.renderRequest=!0;a.viewID=a.options.viewID;h=a.options.core;a.publish=h.publish;a.subscribe=h.subscribe;a.unsubscribe=h.unsubscribe;a.finish=function(){h.stop(a.viewID)};
    a.application=a.options.application;delete a.options;d=_.clone(a.getChildren());a.children=d;$.get(a.url,function(g){var d,c,h,n;n=window.$("<div></div>").html(g).find("[data-template]");0<n.length&&(a.innerTemplate=[]);c=0;for(h=n.length;c<h;c+=1)d=n.get(c),d=d.innerHTML,a.innerTemplate[c]=_.template(d?d.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"'):d);a.template=_.template(g);a.bindModel(a.model);a.loader.resolve()},"text");a.subscribe(a.viewID,a.receiveMsg,
        a);a.oninit();a.onInitialize();a.setExtras(g);return a},setExtras:function(a){a!==this.extras&&(this.onNewExtras(a),this.extras=a)},bindModel:function(a){var d;if(a){this.model=a;for(d=this.listen.length-1;-1<d;d-=1)this.listenTo(a,this.listen[d],this.render);this.template&&!this.renderRequest&&a.trigger("change")}},unbindModel:function(a){this.model&&(this.stopListening(this.model),this.model=null,a&&this.render())},changeModel:function(a){this.unbindModel();this.bindModel(a)},render:function(){function a(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        c){var k=RAD.core.getView(c.content,c.extras),b=a.$(c.container_id);c&&c.backstack&&RAD.core.publish("router.beginTransition",c);k.appendIn(b,function(){b.attr("view",c.content);"function"===typeof c.callback&&("object"===typeof c.context?c.callback.call(c.context):c.callback())})}var d=this.model?this.model.toJSON():void 0,h,g,m,p;this.onStartRender();h=this.getChildren();g=0;for(m=h.length;g<m;g+=1)RAD.core.getView(h[g].content,h[g].extras).detach();try{if(this.innerTemplate&&!this.renderRequest)for(g=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,m=this.innerTemplate.length;g<m;g+=1)$(this.$inner[g]).html(this.innerTemplate[g].apply(this,[{model:d}]));else if(this.$el.html(this.template({model:d})),this.innerTemplate)for(this.$inner=[],p=this.$("[data-template]"),g=0,m=this.innerTemplate.length;g<m;g+=1)this.$inner[g]=p.get(g)}catch(c){return window.console.log("Error rendering in"+this.viewID+": "+c.toString()),this}g=0;for(m=h.length;g<m;g+=1)a(this,h[g]);this.onrender();this.onEndRender();this.initScrollRefresh();this.renderRequest=!1;
    return this},appendIn:function(a,d){var h=this,g=$(a);a&&0!==g.length?(g.append(h.$el),h.renderRequest?h.loader.doneFirstTask(function(){h.render();h.attachScroll();d()}):(h.attachScroll(),d())):window.console.log("Container for "+h.viewID+" doesn't exist!")},initScrollRefresh:function(a){a=a||this.el;var d=document.createEvent("Event");d.initEvent("scrollRefresh",!0,!0);a.dispatchEvent(d);this.refreshScroll()},receiveMsg:function(a,d){var h=this;switch(a.split(".")[2]){case "attach":h.loader.done(function(){h.onattach();
    h.onStartAttach(a,d)});break;case "detach":h.ondetach();h.onEndDetach(a,d);break;case "attach_complete":h.loader.doneLastTask(function(){h.onEndAttach(a,d)});break;default:h.onReceiveMsg(a,d)}return h},detach:function(){this.detachScroll();this.$el.detach()},destroy:function(){var a;this.onDestroy();this.ondestroy();this.unbindModel();this.off(null,null,this);this.unsubscribe(this.viewID,this);this.undelegateEvents();this.$el.removeData().unbind();this.remove();window.Backbone.View.prototype.remove.call(this);
    for(a in this)this.hasOwnProperty(a)&&delete this[a];return this},oninit:function(){},onattach:function(){},ondetach:function(){},onrender:function(){},ondestroy:function(){},attachScroll:function(){},refreshScroll:function(){},detachScroll:function(){},onInitialize:function(){},onNewExtras:function(){},onReceiveMsg:function(){},onStartRender:function(){},onEndRender:function(){},onStartAttach:function(){},onEndAttach:function(){},onEndDetach:function(){},onDestroy:function(){}}));
RAD.namespace("RAD.Blanks.Service",RAD.Class.extend({initialize:function(a){this.publish=a.core.publish;this.subscribe=a.core.subscribe;this.unsubscribe=a.core.unsubscribe;this.serviceID=this.viewID=a.viewID;this.application=a.application;this.subscribe(this.serviceID,this.onReceiveMsg,this);this.onInitialize()},destroy:function(){this.onDestroy();this.unsubscribe(null,this)},onInitialize:function(){},onReceiveMsg:function(){},onDestroy:function(){}}));
RAD.namespace("RAD.Blanks.ScrollableView",RAD.Blanks.View.extend({className:"scroll-view",offsetY:0,attachScroll:function(){var a=this,d=a.el.querySelector(".scroll-view")||a.el;a.detachScroll();a.loader.done(function(){a.renderRequest||(a.mScroll=new window.iScroll(d,{bounce:!1,onBeforeScrollStart:function(a){for(var g=a.target;1!==g.nodeType;)g=g.parentNode;"SELECT"!==g.tagName&&("INPUT"!==g.tagName&&"TEXTAREA"!==g.tagName)&&a.preventDefault()}}))})},onattach:function(){var a=this;window.setTimeout(function(){a.mScroll&&
(a.mScroll.refresh(),a.mScroll.scrollTo(0,a.offsetY,0))},0)},refreshScroll:function(){this.mScroll&&this.mScroll.refresh()},detachScroll:function(){this.mScroll&&(this.offsetY=this.mScroll.y,this.mScroll.destroy(),this.mScroll=null)}}));
RAD.namespace("RAD.Blanks.Toast",RAD.Blanks.View.extend({className:"toast",closeTimeOut:void 0,showTime:4E3,close:function(){clearTimeout(this.closeTimeOut);var a={content:this.viewID};$(document.body).off("click.close");this.publish("navigation.toast.close",a)},onattach:function(){var a=this;a.closeTimeOut=window.setTimeout(function(){a.close()},a.showTime);$(document.body).one("click.close",function(){a.close()})}}));
RAD.namespace("RAD.Blanks.Popup",RAD.Blanks.ScrollableView.extend({className:"popup",close:function(){var a={content:this.viewID,destroy:this.onCloseDestroy},d;d=this.viewID.split(".");d=d[d.length-1];$(document.body).off("tapdown."+d);$(document.body).off("click."+d);this.publish("navigation.popup.close",a)},onattach:function(a,d){function h(){m.close()}function g(a){a.stopPropagation()}var m=this,p;p=m.viewID.split(".");RAD.Blanks.ScrollableView.prototype.onattach.call(m);p=p[p.length-1];m.outSideClose&&
(m.$el.on("tapdown."+p,g),m.$el.on("click."+p,g),$(document.body).one("tapdown."+p,h),$(document.body).one("click."+p,h));$(window).one("orientationchange."+p,h)},ondetach:function(){var a;a=this.viewID.split(".");a=a[a.length-1];$(document.body).off("tapdown."+a);$(document.body).off("click."+a);this.$el.off("tapdown."+a);this.$el.off("click."+a);$(window).off("orientationchange."+a)}}));
RAD.plugin("plugin.fastclick",function(a){this.swipe=new function(a){function h(a){var b={},e=a;c.touch&&(a.touches&&a.touches[0]&&"touchend"!==a.type?e=a.touches[0]:a.changedTouches&&a.changedTouches[0]&&(e=a.changedTouches[0]));b.screenX=e.screenX;b.screenY=e.screenY;b.clientX=e.clientX;b.clientY=e.clientY;return b}function g(a,b,e,c){return Math.abs(a-e)>Math.abs(b-c)?a>e?"left":"right":b>c?"top":"bottom"}function m(a,b){var e=h(b),c=document.createEvent("Event");c.initEvent(a,!0,!0);c[a]={clientX:e.clientX,
    clientY:e.clientY,screenX:e.screenX,screenY:e.screenY,timeStamp:b.timeStamp};b.target.dispatchEvent(c)}function p(a){var b=h(a);q=n;n={screenX:b.screenX,screenY:b.screenY,timeStamp:a.timeStamp}}var c=this,q,n;c.down=function(a){var b=h(a);c.startX=b.screenX;c.startY=b.screenY;c.startClientX=b.clientX;c.startClientY=b.clientY;c.timeStamp=a.timeStamp;c.moved=!1;c.isDown=!0;c.touchStartTime=(new Date).getTime();q=n={screenX:0,screenY:0,timeStamp:(new Date).getTime()};p(a);m("tapdown",a)};c.move=function(a){var b=
    h(a);c.isDown&&m("tapmove",a);if(10<Math.abs(b.screenX-c.startX)||10<Math.abs(b.screenY-c.startY))c.moved=!0,p(a)};c.cancel=function(a){c.isDown&&(c.touch?c.up(a):m("tapcancel",a))};c.clear=function(a){m("tapclear",a)};c.up=function(a){var b,e=h(a),f,l;l=(new Date).getTime()-c.touchStartTime;if(c.isDown){c.isDown=!1;!c.moved&&200>=l&&m("tap",a);l=e.screenX-q.screenX;f=e.screenY-q.screenY;l=(Math.pow(l*l+f*f,0.5)/(a.timeStamp-q.timeStamp)).toFixed(3);if(c.moved&&0<l){f=q.screenX;var d=q.screenY,n=
    q.timeStamp,p=e.screenX,G=e.screenY,O=a.timeStamp;switch(g(f,d,p,G)){case "left":b=f-p;break;case "right":b=p-f;break;case "top":b=d-G;break;case "bottom":b=G-d}f=(b/(O-n)).toFixed(3);b=document.createEvent("Event");b.initEvent("swipe",!0,!0);b.swipe={start:{screenX:c.startX,screenY:c.startY,clientX:c.startClientX,clientY:c.startClientY,timeStamp:c.timeStamp},end:{screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY,timeStamp:a.timeStamp},velocity:l,direction:g(c.startX,c.startY,
    e.screenX,e.screenY),speed:f};a.target.dispatchEvent(b)}m("tapup",a)}};c.destroy=function(){this.touch?(this.el.removeEventListener("touchstart",this.down),this.el.removeEventListener("touchend",this.up),this.el.removeEventListener("touchmove",this.move),this.el.removeEventListener("touchcancel",this.cancel)):(this.el.removeEventListener("mousedown",this.down),this.el.removeEventListener("mouseup",this.up),this.el.removeEventListener("mousemove",this.move),this.el.removeEventListener("mouseout",this.cancel),
    this.el.removeEventListener("mouseover",this.clear));delete this.el};c.el=a;a=null;c.touch=void 0!==window.ontouchstart;c.touch?(c.el.addEventListener("touchstart",c.down,!1),c.el.addEventListener("touchend",c.up,!1),c.el.addEventListener("touchmove",c.move,!1),c.el.addEventListener("touchcancel",c.cancel,!1)):(c.el.addEventListener("mousedown",c.down,!1),c.el.addEventListener("mouseup",c.up,!1),c.el.addEventListener("mousemove",c.move,!1),c.el.addEventListener("mouseout",c.cancel,!1),c.el.addEventListener("mouseover",
    c.clear,!1));return c}(a.document.body);return this});
RAD.plugin("plugin.navigator",function(a,d){function h(a,e,b){"function"===typeof a&&("object"===typeof e?a.apply(e,b):a(b))}function g(a,e){var b,c=a.querySelector(e);c&&c.getAttribute&&(b=c.getAttribute("view"));return b}function m(e){function b(a){if(!a||!a.parentNode)return null;if((a=a.parentNode)&&a.getAttribute)return(c=a.getAttribute("view"))?c:b(a)}var c;return b(a.document.querySelector(e))}function p(e){var b,c,f,l,g,d=[];if(!e)return d;e=e.getChildren();f=0;for(l=e.length;f<l;f+=1)for(b=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          e[f].content,d.push(b),g=p(a.getView(b)),b=0,c=g.length;b<c;b+=1)d.push(g[b]);return d}function c(e,c){var d=a.getView(e.content,a.extractExtras(e)),g,k,m=!1;null===d||void 0===d||d.isShown||(d.isShown=!0,g=d.$el,k=function(){m||(m=!0,h(e.callback,e.context,d),r.removeClass("show"),g.off(l,k),a.publish(e.content+".attach",null),d=null)},r.addClass("show"),b.setTimeout(k,f),d.appendIn("body",function(){g.attr("id",e.content);switch(c){case "dialog":g.addClass("lightbox");break;case "toast":var a=d.el,
    f=0,h=0,r=a.offsetWidth,m=a.offsetHeight,p=b.innerWidth,n=b.innerHeight;switch(e.gravity){case "center":f=(p-r)/2;h=(n-m)/2;break;case "left":h=(n-m)/2;break;case "right":f=p-r;h=(n-m)/2;break;case "bottom":f=(p-r)/2;h=n-m;break;default:f=(p-r)/2}a.style.left=Math.round(f+b.pageXOffset)+"px";a.style.top=Math.round(h+b.pageYOffset)+"px";break;case "popup":var a=d.el,f=e.target,h=e.gravity,r=e.width,m=e.height,p=b.innerWidth,n=b.innerHeight,q=r||150,s=m||150,C=0,v=0,w=$(f),D=w.offset().top,z=w.offset().left,
    A=w.outerWidth(),w=w.outerHeight(),x=h&&0<h.length&&-1!=="top bottom left right center".indexOf(h),M=b.getComputedStyle(a),F=a.querySelector(".popup-pointer"),K=0,K=0;x||(h="center",q<z-0&&s<n-0&&(h="left"),q<p-0&&s<n-(D+w)&&(h="bottom"),q<p-(z+A)&&s<n-0&&(h="right"),q<p-0&&s<D-0&&(h="top"));switch(h){case "center":C=(p-q)/2;v=(n-s)/2;break;case "top":C=z-q/2+A/2;v=D-s;break;case "bottom":C=z-q/2+A/2;v=D+w;break;case "left":v=D-s/2+w/2;C=z-q;break;case "right":v=D-s/2+w/2,C=z+A}a.style.left=Math.round(C+
    b.pageXOffset)+"px";a.style.top=Math.round(v+b.pageYOffset)+"px";a.style.width=r+"px";a.style.height=m+"px";if(F){F.style.top="";F.style.left="";F.className="popup-pointer "+h;if("top"===h||"bottom"===h)K=F.offsetWidth/2+parseInt(M.paddingLeft,10),F.style.left=z+Math.round(f.offsetWidth/2)-C-K+"px";if("left"===h||"right"===h)K=F.offsetHeight/2+parseInt(M.paddingTop,10),F.style.top=D+Math.round(f.offsetHeight/2)-v-K+"px"}}g.on(l,k);g.width();g.addClass("show")}))}function q(e){var c=a.getView(e.content),
    d=c.$el,g,k=!1;b.document.activeElement&&b.document.activeElement.blur();g=function(){k||(k=!0,c.detach(),h(e.callback,e.context,c),r.removeClass("show"),d.off(l,g),a.publish(e.content+".detach",null),e&&void 0!==e.destroy&&!0!==e.destroy?c.isShown=!1:a.stop(e.content),c=null)};r.addClass("show");d.on(l,g);b.setTimeout(function(){g()},f);d.removeClass("show")}function n(e,b){function f(e){var b=e?e.backstack:void 0;(b||s&&void 0===b)&&a.publish("router.beginTransition",e)}var l=e.split("."),d;switch(l[1]){case "show":if("[object Array]"===
    Object.prototype.toString.call(b))for(l=0,d=b.length;l<d;l+=1)f(b[l]),x.animate(b[l],!1);else f(b),x.animate(b,!1);break;case "back":l=void 0!==b.direction?b.direction:!0;x.animate(b,l);break;case "toast":case "popup":case "dialog":switch(l[2]){case "show":c(b,l[1]);break;case "close":q(b)}}}var k={},b=a.window,e=a.options.defaultAnimation||"slide",f=a.options.animationTimeout||1E3,l="transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",r,s=a.options&&void 0!==a.options.defaultBackstack?
    a.options.defaultBackstack:!1,x;x=new function(){function c(e,b){var f,l;f=0;for(l=b.length;f<l;f+=1)a.publish(b[f]+"."+e)}var f={inAnimation:0,animate:function(d,k){function n(){b.setTimeout(function(){t&&t.el&&(b.getComputedStyle(t.el,null).getPropertyValue("left"),c("attach",v));t||y?E.addClass("animate"):r.removeClass("show")},0)}function q(){f.inAnimation-=1;0===f.inAnimation&&r.removeClass("show");h(d.callback,d.context,[t,y]);c("detach",w);c("attach_complete",v);a.publish("router.endTransition",
    d)}var s,x,t,y,E,u,B,J="",L,C=!1,v,w=[],D,z,A,N;b.document.activeElement&&b.document.activeElement.blur();if(null!==d&&void 0!==d)if(B=d.animation||e,E=a.$(d.container_id),t=a.getView(d.content,a.extractExtras(d)),(y=(u=E.attr("view"))?a.getView(u):void 0)&&y.viewID===(t&&t.viewID))b.console.log("You try navigate the same view:"+y.viewID+" as old and new widget!");else{if(u=g(a.document,d.container_id))w=p(a.getView(u)),w.push(u);v=p(t);v.push(d.content);if(u=m(d.container_id)){u=a.getView(u);u=u.getChildren();
    z={container_id:d.container_id,content:d.content,animation:d.animation};if(u)for(A=0,N=u.length;A<N;A+=1)if(D=u[A],D.container_id===z.container_id){u.splice(A,1);break}u.push(z)}E.attr("view",d.content);s=t?t.$el:void 0;x=y?y.$el:void 0;r.addClass("show");f.inAnimation+=1;"none"===d.animation||"none"===e&&!d.animation?(y&&y.detach(),s&&t.appendIn(d.container_id,function(){c("attach",v)}),q()):(L=function(a){a=a&&(t&&a.target===t.el||y&&a.target===y.el);!C&&a&&(E.removeClass("animate"),s&&s.removeClass("new-page "+
    J),x&&(x.removeClass("old-page "+J),y.detach()),E.off(l,L),q(),C=!0)},E.on(l,L),b.setTimeout(L,4E3),J=k?-1!==B.indexOf("-out")?B.replace("-out","-in"):-1!==B.indexOf("-in")?B.replace("-in","-out"):B+"-out":-1!==B.indexOf("-out")||-1!==B.indexOf("-in")?B:B+"-in",x&&x.addClass("old-page "+J),s?(s.addClass("new-page "+J),t.appendIn(E,n)):n())}}};return f};a.subscribe("navigation",n,k);r=a.$("#overlay");k.viewID=d;k.destroy=function(){a.unsubscribe(n,k)};return k});
RAD.plugin("plugin.router",function(a,d){function h(a){var b,c,d;b=a.childNodes;c=0;for(d=b.length;c<d;c+=1)if(b[c].getAttribute&&(a=b[c].getAttribute("view")))return{content:a,container_id:"#"+b[c].getAttribute("id")};c=0;for(d=b.length;c<d;c+=1)if(a=h(b[c]))return a}function g(b){var c,d,h,k,m=[];if(!b)return m;b=b.getChildren();c=0;for(d=b.length;c<d;c+=1)k=_.clone(b[c]),m.push(k),h=k.content,(h=g(a.getView(h)))&&0<h.length&&(k.children=h);m.sort(function(a,b){var c=a.container_id,e=b.container_id,
    f=0;c>e?f=1:c<e&&(f=-1);return f});return m}function m(a){var b={};a=a.split("$$$");b.urlObj=JSON.parse(decodeURIComponent((a[0]+"").replace(/\+/g,"%20")));b.timestamp=a[1];return b}function p(a,b){switch(a.split(".")[1]){case "beginTransition":q.onNewTransition();break;case "endTransition":q.pushToStackRequest&&q.saveScoopeAsURL();break;case "back":q.back();break;case "clear":q.clearAndBlock()}}var c={},q,n=[],k=!1,b=function(a){var b="function"===typeof history.pushState?"native":"hashbang",c=["native",
    "hashbang","custom"];a&&0<c.indexOf(a)&&(b=a);return b}(a.options.backstackType);q={currentID:Math.floor(1E5*Math.random()),currentURL:void 0,lastURL:void 0,toBack:!0,isBlocked:!1,stack:new function(){var a,b=-1,c=[];this.push=function(d){var g;b!==c.length-1&&(g=b+1,c=c.slice(0,g));void 0!==a&&null!==a&&c.push(a);a=d;b=c.length-1};this.getCurrent=function(){return void 0!==a&&null!==a?a:c[b]};this.getNext=function(){var a,e;a=b+1;-1<a&&a<c.length&&(e=c[a],b=a);return e};this.getPrevious=function(){var d,
    g;a&&(c.push(a),b=c.length-1,a=null);d=b-1;-1<d&&d<c.length&&(g=c[d],b=d);return g};this.clear=function(){a=null;c=[];b=c.length-1};return this},pushToStackRequest:!1,navigate:function(a){switch(b){case "native":history.pushState({url:a,id:this.currentID},null,null);break;case "hashbang":k=!0;window.location.href="index.html#!"+a+"%%%"+this.currentID;break;case "custom":n.last&&n.push(n.last),n.last={state:{url:a,id:this.currentID}}}this.currentURL=this.lastURL=a;this.pushToStackRequest=!1;this.stack.push(a)},
    saveScoopeAsURL:function(){var b=+(new Date).getTime(),c=h(document.getElementsByTagName("body")[0]),d=a.getView(c.content);(d=g(d))&&0<d.length&&(c.children=d);this.navigate(encodeURIComponent(JSON.stringify(c)).replace(/[!'()]/g,escape).replace(/\*/g,"%2A")+"$$$"+b)},onNewTransition:function(){this.toBack=!0;this.isBlocked=!1;this.pushToStackRequest=!0},back:function(){this.toBack=!0;switch(b){case "native":case "hashbang":history.back();break;case "custom":var a=n.pop();if(a)q.onPopState(a)}},
    clearAndBlock:function(){this.isBlocked=this.toBack=!0;this.lastURL=this.currentURL=void 0;this.currentID=Math.floor(1E5*Math.random());this.stack.clear();n=[];n.last=null},extractDiffer:function(a,b){var c,d,g;for(c in a)if(a.hasOwnProperty(c)&&"children"!==c&&a[c]!==b[c])return delete b.children,b;if(a.hasOwnProperty("children"))for(c=0,d=a.children.length;c<d&&!(g=this.extractDiffer(a.children[c],b.children[c]));c+=1);return g},onPopState:function(b){var c,d;c=!1;d=this.toBack;b.state&&(b.state.id===
        this.currentID&&this.currentURL&&!this.isBlocked)&&(this.lastURL&&this.lastURL===b.state.url&&(c=!0,d=!d),b=d?this.stack.getPrevious():this.stack.getNext(),d=this.toBack?"back":"forward",b?(c&&(this.toBack=!this.toBack),c=this.extractDiffer(m(this.currentURL).urlObj,m(b).urlObj),c.direction=this.toBack,a.publish("navigation.back",c),this.lastURL=this.currentURL,this.currentURL=b,c.direction=d,a.publish("backstack.pop",c)):a.publish("backstack.empty",{direction:d}))}};c.viewID=d;a.subscribe("router",
    p,c);switch(b){case "native":a.window.onpopstate=function(a){q.onPopState(a)};break;case "hashbang":$(window).bind("hashchange",function(){var a=window.location.href.substring(window.location.href.lastIndexOf("#!")+2).split("%%%"),b=a[0],a=parseInt(a[1],10);if(!k)q.onPopState({state:{id:a,url:b}});k=!1})}c.destroy=function(){a.unsubscribe(p,c)};return c});